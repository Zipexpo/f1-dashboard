{"version":3,"file":"static/js/684.1bb9a2dc.chunk.js","mappings":"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","sources":["components/viz/lineChart/index.js","components/viz/Ribbon/index.js","components/viz/Splom/index.js","views/viz/index.js"],"sourcesContent":["import Plot from 'react-plotly.js';\r\n\r\nimport {useEffect, useState, useTransition} from \"react\";\r\n\r\nconst initData=[];\r\nconst domain=[undefined,undefined];\r\nconst layout={title:{text:'',pad:0},margin:{t:10,l:50,b:20,r:30}}\r\nconst LineChart = ({data=initData,xKey,yKey,cKey,colorDomain=domain,mode='line',showscale})=>{\r\n    const [isPending,startTransition] = useTransition();\r\n    const [plotdata,setPlotdata] = useState(initData);\r\n    const [colordata,setColordata] = useState([]);\r\n    useEffect(()=>{\r\n        startTransition(()=>{\r\n            const x=[];\r\n            const y=[];\r\n            data.forEach(d=>{\r\n                x.push(d[xKey]);\r\n                y.push(d[yKey]);\r\n            })\r\n            setPlotdata({\r\n                x,\r\n                y,\r\n            })\r\n        })\r\n    },[xKey,yKey,data]);\r\n    useEffect(()=>{\r\n        if (mode==='markers'){\r\n            debugger\r\n            if (cKey) {\r\n                setColordata(data.map(d=>d[cKey]));\r\n            }else {\r\n                setColordata([]);\r\n            }\r\n        }else\r\n            setColordata([]);\r\n    },[data,cKey,mode])\r\n    const plotopt = [{\r\n        x:plotdata.x,\r\n        y:plotdata.y,\r\n        type: 'scatter',\r\n        mode\r\n        // marker: {color: 'red'},\r\n    }];\r\n    console.log(colorDomain)\r\n    if (colordata.length)\r\n        plotopt[0].marker = {color:colordata, colorscale: \"Portland\",colorbarTitleText: cKey,\r\n            colorbarThickness:5,\r\n            showscale,\r\n            cmin:colorDomain[0],cmax:colorDomain[1]\r\n    }\r\n\r\n    // console.log(JSON.stringify(spec.data.values))\r\n    return (<Plot data={plotopt} style={{width: '100%',height:'100%'}} layout={layout} useResizeHandler={true}/>)\r\n}\r\n\r\nexport default LineChart","import Plot from 'react-plotly.js';\r\n\r\nimport {useEffect, useMemo, useState} from \"react\";\r\nconst initData = [];\r\nconst layout={title:{text:'',pad:0},margin:{t:10,l:50,b:20,r:10}}\r\nconst Chart = ({data=initData, getArr,getName,xKey,yKey,zKey,mode='line'})=>{\r\n    const [plotdata,setPlotdata] = useState(initData);\r\n    useEffect(()=>{\r\n        debugger\r\n        const traceData = data.map(t=>{\r\n            const x=[];\r\n            const y=[];\r\n            const z=[];\r\n            getArr(t).forEach(d=>{\r\n                x.push(d[xKey]);\r\n                y.push(d[yKey]);\r\n                z.push(d[zKey]);\r\n            })\r\n            return{\r\n                name:getName(t),\r\n                x,\r\n                y,\r\n                z,\r\n            }\r\n        })\r\n        setPlotdata(traceData)\r\n    },[xKey,yKey,zKey,data]);\r\n    const plotopt = useMemo(()=>{\r\n        return plotdata.map(d=>({\r\n            ...d,\r\n            type: 'scatter3d',\r\n            colorscale: \"Portland\",\r\n            mode: 'markers',\r\n            marker:{size:3}\r\n        }))\r\n    },[plotdata]);\r\n\r\n    // console.log(JSON.stringify(spec.data.values))\r\n    return (<Plot data={plotopt} style={{width: '100%',height:'100%'}} layout={{...layout,\r\n        scene: {\r\n            xaxis: {\r\n                title: {text: xKey}\r\n            },\r\n            yaxis: {\r\n                title: {text: yKey}\r\n            },\r\n            zaxis: {\r\n                title: {text: zKey}\r\n            }\r\n        }\r\n    }} useResizeHandler={true}/>)\r\n\r\n}\r\n\r\nexport default Chart;","import Plot from 'react-plotly.js';\r\n\r\nimport {useEffect, useMemo, useState} from \"react\";\r\nconst initData = [];\r\nconst initLayout={title:{text:'',pad:0},margin:{t:10,l:50,b:50,r:10},\r\n    hovermode:'closest',\r\n    dragmode:'select',\r\n    plot_bgcolor:'rgba(240,240,240, 0.95)',\r\n    grid:{roworder:'bottom to top'}\r\n};\r\n\r\nconst Chart = ({data=initData, getArr,getName,dimensionKeys,mode='line'})=>{\r\n    const [plotdata,setPlotdata] = useState(initData);\r\n    const [layout,setLayout] = useState(initLayout);\r\n    useEffect(()=>{\r\n        const traceData = data.map(t=>{\r\n            const dimensions = dimensionKeys.map(k=> ({label:k, values:[]}));\r\n            getArr(t).forEach(d=>{\r\n                dimensions.forEach((k)=>{\r\n                    k.values.push(d[k.label]);\r\n                });\r\n            })\r\n            return {\r\n                type: 'splom',\r\n                name:getName(t),\r\n                dimensions,\r\n                marker: {\r\n                    size: 5,\r\n                    line: {\r\n                        color: 'white',\r\n                        width: 0.5\r\n                    }\r\n                }\r\n            }\r\n        })\r\n        setPlotdata(traceData)\r\n    },[dimensionKeys,data]);\r\n    useEffect(()=>{\r\n        const layout = {...initLayout};\r\n        dimensionKeys.forEach((k,i)=> {\r\n            layout[`xaxis${i}`] = axis()\r\n            layout[`yaxis${i}`] = axis()\r\n        })\r\n        setLayout(layout)\r\n    },[dimensionKeys])\r\n    const axis = () => ({\r\n        showline:false,\r\n        zeroline:false,\r\n        gridcolor:'#ffff',\r\n        ticklen:4\r\n    })\r\n    // console.log(JSON.stringify(spec.data.values))\r\n    return (<Plot data={plotdata} style={{width: '100%',height:'100%'}} layout={layout} useResizeHandler={true}/>)\r\n\r\n}\r\n\r\nexport default Chart;","import {useSelector} from \"react-redux\";\r\nimport {\r\n    selectDatas\r\n} from \"../../store/actions/dataProcess\";\r\nimport {gridSpacing} from \"../../store/constant\";\r\nimport {Card, Grid, Typography, Box, Autocomplete, TextField, Stack, MenuItem} from \"@mui/material\";\r\nimport {lazy, useEffect, useState} from \"react\";\r\nimport {groups,extent as d3extent,min as d3min, max as d3max} from \"d3\";\r\nimport Loadable from '../../components/Loadable';\r\n\r\n\r\n// dashboard routing\r\n// const LineChart = Loadable(lazy(() => import('../../components/viz/lineChart')));\r\n// const RibbonChart = Loadable(lazy(() => import('../../components/viz/Ribbon')));\r\nimport LineChart from \"../../components/viz/lineChart\";\r\n// import LineChart from \"../../components/viz/lineChart/subplots\";\r\nimport RibbonChart from \"../../components/viz/Ribbon\";\r\nimport SplomChart from \"../../components/viz/Splom\";\r\n\r\n// fix this later\r\nconst Viz = ()=>{\r\n    const datas = useSelector(selectDatas);\r\n    const [nestData,stNestData] = useState([]);\r\n    const [dimension,setDimension] = useState([]);\r\n    const [dimensionDetail,setDimensionDetail] = useState({});\r\n    const [plotType,setPlotType] = useState('lines');\r\n    const [layout,setLayout] = useState([]);\r\n    const [axis,setAxis] = useState([{label:'x',key:\"index\"},\r\n        {label:'y',key:\"voltage\"},\r\n        {label:'z',key:null,is3D:true},\r\n        {label:'color',key:null},\r\n        {label:'dim',key:[]},\r\n    ]);\r\n        // {key:\"gpu_usage\"}]);\r\n    // need to move this in the future\r\n    useEffect(()=>{\r\n        const newProfile = groups(datas,d=>d.Profile);\r\n        const positionK = {};\r\n        const flatdata = [];\r\n        const newdata = newProfile.map(([p,pd])=>{\r\n            const app = Object.keys(positionK).map(k=>[k,[]]);\r\n            pd.forEach(d=>{\r\n                if (positionK[d.AppName]===undefined){\r\n                    positionK[d.AppName] = app.length;\r\n                    app[positionK[d.AppName]]=[d.AppName,[]];\r\n                }\r\n                app[positionK[d.AppName]][1].push(d);\r\n                flatdata.push(d.data);\r\n            })\r\n            return [p,app]\r\n        })\r\n        stNestData(newdata);\r\n        const dimensionDetail = {};\r\n        if (datas[0]&&datas[0].data&&datas[0].data[0]) {\r\n            let dim = Object.keys(datas[0].data[0]);\r\n            dim.forEach(k=>{\r\n                dimensionDetail[k] = [+Infinity,-Infinity];\r\n                const ex = flatdata.map(d=>d3extent(d,d=>+d[k]));\r\n                dimensionDetail[k] = [d3min(ex,d=>d[0]),d3max(ex,d=>d[1])];\r\n            })\r\n            setDimension(dim)\r\n        }else\r\n            setDimension([]);\r\n        setDimensionDetail(dimensionDetail);\r\n    },[datas]);\r\n    const onChangeAxis = (key,value)=>{\r\n        axis[key].key = value;\r\n        setAxis([...axis])\r\n    }\r\n    const largeLayout = ((plotType==='markers')||(plotType==='lines')||(plotType==='Splom'));\r\n    const renderAxis = ()=>{\r\n        switch (plotType){\r\n            case 'markers':\r\n            case 'lines':\r\n                return axis.map((a,i)=><Autocomplete value={a.key} key={a.label}\r\n                                                     size={\"small\"}\r\n                                                     sx={{minWidth:200,display:a.is3D ?'none':undefined}}\r\n                                                     options={dimension}\r\n                                                     onChange={(event, newValue) => onChangeAxis(i, newValue)}\r\n                                                     renderInput={(params) => <TextField {...params} label={a.label}/>}/>)\r\n            case 'Splom':\r\n                return <Autocomplete value={axis[4].key}\r\n                                     multiple\r\n                                     size={\"small\"}\r\n                                     options={dimension}\r\n                                     onChange={(event, newValue) => onChangeAxis(4, newValue)}\r\n                                     renderInput={(params) => <TextField {...params} label={axis[4].label}/>}/>\r\n            default:\r\n                return axis.map((a,i)=><Autocomplete value={a.key} key={a.label}\r\n                                                     size={\"small\"}\r\n                                                     sx={{minWidth:200,display:a.label==='color' ?'none':undefined}}\r\n                                                     options={dimension}\r\n                                                     onChange={(event, newValue) => onChangeAxis(i, newValue)}\r\n                                                     renderInput={(params) => <TextField {...params} label={a.label}/>}/>)\r\n        }\r\n    }\r\n    const renderPlots = ([profile,pData])=>{\r\n        switch (plotType){\r\n            case 'markers':\r\n            case 'lines':\r\n                return <Grid container>\r\n                    {pData.map(([app, appData],i) => <Grid key={`${profile} ${app}`} item xs={4}\r\n                                                           sx={{height: 200, mb: 3}}>\r\n                        <Typography variant={'h5'} textAlign={'center'}>{app}</Typography>\r\n                        {appData[0] &&\r\n                            <LineChart data={appData[0]?.data} xKey={axis[0].key} yKey={axis[1].key}\r\n                                       cKey={axis[3].key}\r\n                                       colorDomain={dimensionDetail[axis[3].key]}\r\n                                       getArr={([k,t])=>t[0]?t[0].data:[]}\r\n                                       getName={([k,t])=>k}\r\n                                       mode={plotType}\r\n                                       showscale={i===2}\r\n                            />}\r\n                    </Grid>)}\r\n                </Grid>\r\n            case 'Splom':\r\n                return <SplomChart\r\n                    getArr={([k,t])=>t[0]?t[0].data:[]}\r\n                    getName={([k,t])=>k}\r\n                    data={pData}\r\n                    dimensionKeys={axis[4].key}\r\n                />\r\n            case 'Ribbon':\r\n                return <RibbonChart\r\n                    getArr={([k,t])=>t[0]?t[0].data:[]}\r\n                    getName={([k,t])=>k}\r\n                    data={pData}\r\n                    xKey={axis[0].key}\r\n                    yKey={axis[1].key}\r\n                    zKey={axis[2].key}\r\n                    cKey={axis[3].key}\r\n                />\r\n            default:\r\n                return <>Not support yet</>\r\n        }\r\n    }\r\n    return(\r\n        <Grid container spacing={gridSpacing}>\r\n            <Grid item xs={12} >\r\n                <Stack spacing={2} direction={\"row\"}>\r\n                    <TextField\r\n                        select\r\n                        label=\"Plot type\"\r\n                        size=\"small\"\r\n                        sx={{minWidth:200}}\r\n                        value={plotType}\r\n                        onChange={(event)=>setPlotType(event.target.value)}\r\n                    >\r\n                        <MenuItem value={'markers'}>\r\n                            Scatter plot\r\n                        </MenuItem>\r\n                        <MenuItem value={'lines'}>\r\n                            Line chart\r\n                        </MenuItem>\r\n                        <MenuItem value={'Ribbon'}>\r\n                            3D scatter plot\r\n                        </MenuItem>\r\n                        <MenuItem value={'Splom'}>\r\n                            Splom\r\n                        </MenuItem>\r\n                        <MenuItem value={'pca'}>\r\n                            PCA\r\n                        </MenuItem>\r\n                    </TextField>\r\n                {renderAxis()}\r\n                </Stack>\r\n            </Grid>\r\n            {\r\n                nestData.map(([profile,pData])=>(<Grid item key={profile} xs={largeLayout?12:6} >\r\n                    <Card>\r\n                        <Box sx={{ p: 2, pl: 2 }}>\r\n                            <Typography variant={'h3'}>{profile}</Typography>\r\n                            {\r\n                                renderPlots([profile,pData])\r\n                            }\r\n                        </Box>\r\n                    </Card>\r\n                </Grid>))\r\n            }\r\n        </Grid>\r\n    )\r\n}\r\n\r\nexport default Viz;"],"names":["initData","domain","undefined","layout","title","text","pad","margin","t","l","b","r","data","xKey","yKey","cKey","colorDomain","mode","showscale","useTransition","startTransition","useState","plotdata","setPlotdata","colordata","setColordata","useEffect","x","y","forEach","d","push","map","plotopt","type","console","log","length","marker","color","colorscale","colorbarTitleText","colorbarThickness","cmin","cmax","style","width","height","useResizeHandler","getArr","getName","zKey","traceData","z","name","useMemo","size","scene","xaxis","yaxis","zaxis","initLayout","hovermode","dragmode","plot_bgcolor","grid","roworder","dimensionKeys","setLayout","dimensions","k","label","values","line","i","axis","showline","zeroline","gridcolor","ticklen","datas","useSelector","selectDatas","nestData","stNestData","dimension","setDimension","dimensionDetail","setDimensionDetail","plotType","setPlotType","key","is3D","setAxis","newProfile","groups","Profile","positionK","flatdata","newdata","p","pd","app","Object","keys","AppName","dim","Infinity","ex","d3extent","d3min","d3max","onChangeAxis","value","largeLayout","renderPlots","profile","pData","Grid","container","appData","item","xs","sx","mb","Typography","variant","textAlign","Splom","Ribbon","spacing","gridSpacing","Stack","direction","TextField","select","minWidth","onChange","event","target","MenuItem","a","Autocomplete","display","options","newValue","renderInput","params","multiple","renderAxis","Card","Box","pl"],"sourceRoot":""}